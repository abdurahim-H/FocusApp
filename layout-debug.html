<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Layout Debug - Cosmic Focus</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components.css">
    <style>
        /* Debug styles to highlight layout changes */
        .debug-border {
            border: 2px solid red !important;
        }
        
        .layout-change-indicator {
            position: fixed;
            top: 10px;
            right: 10px;
            background: red;
            color: white;
            padding: 10px;
            z-index: 9999;
            display: none;
        }
        
        .container {
            border: 1px dashed yellow;
        }
        
        .task-item {
            border: 1px dotted cyan;
            margin: 2px 0;
        }
        
        /* Add visual indicators for when classes are applied */
        .productivity-glow {
            border: 3px solid lime !important;
        }
        
        .task-celebration {
            border: 3px solid orange !important;
        }
        
        .cosmic-flow {
            border: 3px solid purple !important;
        }
    </style>
</head>
<body>
    <div class="layout-change-indicator" id="layoutIndicator">
        LAYOUT CHANGE DETECTED!
    </div>
    
    <div class="container">
        <h1>Layout Debug Test</h1>
        
        <div class="input-group">
            <input type="text" id="taskInput" placeholder="Enter a task..." value="Test task for debugging">
            <button class="btn" onclick="addTask()">Add Task</button>
        </div>
        
        <ul id="taskList" class="task-list">
            <!-- Tasks will be rendered here -->
        </ul>
        
        <div id="debugInfo">
            <h3>Debug Information:</h3>
            <div id="containerClasses">Container classes: </div>
            <div id="taskCount">Tasks: </div>
            <div id="productivity">Productivity: </div>
        </div>
    </div>

    <script type="module">
        import { state } from './js/state.js';
        import { addTask, toggleTask, renderTasks } from './js/tasks.js';
        import { initUIEffects } from './js/ui-effects.js';
        
        // Make functions globally available
        window.addTask = addTask;
        window.toggleTask = toggleTask;
        
        // Debug monitoring
        let lastContainerClasses = '';
        let lastTaskCount = 0;
        
        function updateDebugInfo() {
            const container = document.querySelector('.container');
            const tasks = state.tasks || [];
            const completed = tasks.filter(t => t.completed).length;
            const productivity = tasks.length > 0 ? (completed / tasks.length * 100).toFixed(1) : 0;
            
            document.getElementById('containerClasses').textContent = `Container classes: ${container.className}`;
            document.getElementById('taskCount').textContent = `Tasks: ${tasks.length} (${completed} completed)`;
            document.getElementById('productivity').textContent = `Productivity: ${productivity}%`;
            
            // Detect changes
            if (container.className !== lastContainerClasses || tasks.length !== lastTaskCount) {
                console.log('üö® LAYOUT CHANGE DETECTED!');
                console.log('Previous container classes:', lastContainerClasses);
                console.log('New container classes:', container.className);
                console.log('Previous task count:', lastTaskCount);
                console.log('New task count:', tasks.length);
                
                const indicator = document.getElementById('layoutIndicator');
                indicator.style.display = 'block';
                setTimeout(() => {
                    indicator.style.display = 'none';
                }, 2000);
                
                lastContainerClasses = container.className;
                lastTaskCount = tasks.length;
            }
        }
        
        // Monitor for changes every 100ms
        setInterval(updateDebugInfo, 100);
        
        // Initialize
        initUIEffects();
        renderTasks();
        updateDebugInfo();
        
        console.log('üîç Layout debug page initialized');
        console.log('üîç Add a task and toggle its checkbox to see layout changes');
    </script>
</body>
</html>
